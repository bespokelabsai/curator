interactions:
  - request:
      method: POST
      uri: https://bedrock.us-east-1.amazonaws.com/model/anthropic.claude-3-haiku-20240307-v1:0/batch
      body:
        inputConfig:
          s3Uri: s3://test-bucket/input/test-job.jsonl
          dataInputConfig:
            contentType: application/json
            inputFormat: jsonlines
        outputConfig:
          s3Uri: s3://test-bucket/output/test-job/
          dataOutputConfig:
            contentType: application/json
        modelId: anthropic.claude-3-haiku-20240307-v1:0
        roleArn: test-role
      headers:
        Content-Type: application/json
        Accept: application/json
    response:
      status: 200
      body:
        jobId: test-job-123
        status: IN_PROGRESS
        creationTime: '2024-02-18T12:00:00Z'
      headers:
        Content-Type: application/json

  - request:
      method: GET
      uri: https://bedrock.us-east-1.amazonaws.com/model/anthropic.claude-3-haiku-20240307-v1:0/batch/test-job-123
      headers:
        Accept: application/json
    response:
      status: 200
      body:
        jobId: test-job-123
        status: FAILED
        creationTime: '2024-02-18T12:00:00Z'
        completionTime: '2024-02-18T12:05:00Z'
        outputLocation: s3://test-bucket/output/test-job-123/
        requestCounts:
          total: 3
          succeeded: 1
          failed: 2
          retried: 0
        failureReason: "Some requests failed processing"
      headers:
        Content-Type: application/json

  - request:
      method: GET
      uri: https://s3.us-east-1.amazonaws.com/test-bucket/output/test-job-123/results.jsonl
      headers:
        Accept: application/json
    response:
      status: 200
      body: |
        {"completion": "Here is a recipe for pasta carbonara:\n\n1. Cook spaghetti according to package directions\n2. In a bowl, whisk together eggs, grated pecorino and black pepper\n3. Crisp up diced guanciale or pancetta\n4. Toss hot pasta with egg mixture and cured pork\n5. Add pasta water as needed for silky sauce\n\nServe immediately with extra cheese and pepper.", "stop_reason": "stop", "custom_id": "0"}
      headers:
        Content-Type: application/json

  # Second attempt with failed requests
  - request:
      method: POST
      uri: https://bedrock.us-east-1.amazonaws.com/model/anthropic.claude-3-haiku-20240307-v1:0/batch
      body:
        inputConfig:
          s3Uri: s3://test-bucket/input/test-job-retry.jsonl
          dataInputConfig:
            contentType: application/json
            inputFormat: jsonlines
        outputConfig:
          s3Uri: s3://test-bucket/output/test-job-retry/
          dataOutputConfig:
            contentType: application/json
        modelId: anthropic.claude-3-haiku-20240307-v1:0
        roleArn: test-role
      headers:
        Content-Type: application/json
        Accept: application/json
    response:
      status: 200
      body:
        jobId: test-job-retry-123
        status: IN_PROGRESS
        creationTime: '2024-02-18T12:10:00Z'
      headers:
        Content-Type: application/json

  - request:
      method: GET
      uri: https://bedrock.us-east-1.amazonaws.com/model/anthropic.claude-3-haiku-20240307-v1:0/batch/test-job-retry-123
      headers:
        Accept: application/json
    response:
      status: 200
      body:
        jobId: test-job-retry-123
        status: COMPLETED
        creationTime: '2024-02-18T12:10:00Z'
        completionTime: '2024-02-18T12:15:00Z'
        outputLocation: s3://test-bucket/output/test-job-retry-123/
        requestCounts:
          total: 2
          succeeded: 2
          failed: 0
          retried: 0
      headers:
        Content-Type: application/json

  - request:
      method: GET
      uri: https://s3.us-east-1.amazonaws.com/test-bucket/output/test-job-retry-123/results.jsonl
      headers:
        Accept: application/json
    response:
      status: 200
      body: |
        {"completion": "Here's a recipe for chicken tikka masala:\n\n1. Marinate chicken in yogurt and spices\n2. Grill or broil chicken until charred\n3. Make sauce with tomatoes, cream, and spices\n4. Combine chicken and sauce\n5. Simmer until thickened\n\nServe with naan bread and rice.", "stop_reason": "stop", "custom_id": "1"}
        {"completion": "Here's a recipe for chocolate chip cookies:\n\n1. Cream butter and sugars\n2. Add eggs and vanilla\n3. Mix in flour, baking soda, and salt\n4. Fold in chocolate chips\n5. Bake at 375Â°F for 10-12 minutes\n\nLet cool slightly before enjoying!", "stop_reason": "stop", "custom_id": "2"}
      headers:
        Content-Type: application/json
